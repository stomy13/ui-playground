# 実装計画

- [ ] 1. ルートとページ骨組みの追加
  - TanStack Router に `/compression` を登録し、ホームカードから遷移できる導線を実装
  - `ImageCompression` ページコンポーネントのレイアウトとヘッダー表示を作成
  - _要件: 1.1, 1.2, 1.3_

- [ ] 2. ファイル投入とプレビュー機能
  - 対応拡張子チェックと最大ファイルサイズ検証を実装
  - 画像を選択したらプレビューと元ファイル情報（名前/バイト数）を表示
  - _要件: 2.1, 2.2, 2.3_

- [ ] 3. フォーム入力とバリデーション
  - React Hook Form + Zod/Valibot で幅・高さ・圧縮率のスキーマを構築
  - 縦横比ロックトグルと自動計算ロジックを実装
  - _要件: 3.1, 3.2, 3.3_

- [ ] 4. 圧縮処理インフラの整備
  - Web Worker を作成し、画像リサイズ後のバッファを受け取って処理する仕組みを整備
  - Worker とメインスレッド間のメッセージプロトコルを定義
  - _要件: 4.1, 4.2, 6.2_

- [ ] 5. 圧縮ライブラリレジストリの実装
  - `browser-image-compression` と `@squoosh/lib` (MozJPEG / WebP) を登録する `CompressionRegistry` を実装
  - 各エントリがフォーマット対応と変換ハンドラを提供できるよう型定義を作成
  - _要件: 5.1, 5.2, 6.1, 6.2_

- [ ] 6. 圧縮ジョブ実行フロー
  - 有効な入力で圧縮ボタンがジョブをキューに投入するロジックを実装
  - 各ライブラリの進行状況・成功・失敗状態を Zustand ストアで管理
  - _要件: 4.1, 4.2, 4.3, 6.2_

- [ ] 7. 結果比較 UI
  - ライブラリごとのタブ/アコーディオンと結果カードを描画
  - Before/After プレビュー、サイズ差分、削減率、エラー表示、リトライを実装
  - _要件: 5.1, 5.2, 5.3_

- [ ] 8. ダウンロードと共有
  - 圧縮結果から Blob URL を生成し `ダウンロード` ボタンで保存できるようにする
  - 利用済み Blob URL のクリーンアップを実装
  - _要件: 5.1, 5.2_

- [ ] 9. 通知とアクセシビリティ
  - 失敗時トースト/アラート、入力エラー表示、フォーカス制御を実装
  - 画面リーダー向けラベル、キーボード操作を確認
  - _要件: 2.2, 4.2, 5.3_

- [ ] 10. テストとドキュメント
  - フォームバリデーションとストアロジックの単体テストを追加
  - ワーカー呼び出しのモックテスト、Playwright で主要フローを記述
  - 要件と設計ドキュメントの更新内容を README や `docs/` に反映
  - _要件: 全要件_
